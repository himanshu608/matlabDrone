function B = inertia2(psi,S)

% xb = psi(1);
% yb = psi(2);
% zb = psi(3);
r = psi(4);
p = psi(5);
y = psi(6);
q1 = psi(7);
q2 = psi(8);

l1 = S.l1;
l2 = S.l2;
m1 = S.m1;
m2 = S.m2;
mb = S.mb;
Ix = S.Ib(1);
Iy = S.Ib(2);
Iz = S.Ib(3);

B = [                                                                                                                                                                                                                                      m1 + m2 + mb,                                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -((cos(r)*sin(y) - cos(y)*sin(p)*sin(r))*(m1 + m2 + 5*l1*m1*sin(q1) + 10*l1*m2*sin(q1) + 5*l2*m2*sin(q1 - q2)))/10,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                - m2*cos(y)*(sin(p)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + cos(p)*cos(r)*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10)) - m1*cos(y)*(cos(p)*cos(r)*((l1*sin(q1))/2 + 1/10) + (l1*cos(q1)*sin(p))/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      - m2*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) - m1*((l1*sin(q1))/2 + 1/10)*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y)) - m2*cos(p)*sin(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) - (l1*m1*cos(p)*cos(q1)*sin(y))/2,   - (m2*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + (l1*m1*cos(q1))/2)*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p)) - cos(p)*cos(y)*(m2*(l1*sin(q1) + (l2*sin(q1 - q2))/2) + (l1*m1*sin(q1))/2), (l2*m2*cos(q1 - q2)*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p)))/2 + (l2*m2*sin(q1 - q2)*cos(p)*cos(y))/2;
                                                                                                                                                                                                                                                 0,                                                                                                                                                                                                                                    m1 + m2 + mb,                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ((cos(r)*cos(y) + sin(p)*sin(r)*sin(y))*(m1 + m2 + 5*l1*m1*sin(q1) + 10*l1*m2*sin(q1) + 5*l2*m2*sin(q1 - q2)))/10,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                - m2*sin(y)*(sin(p)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + cos(p)*cos(r)*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10)) - m1*sin(y)*(cos(p)*cos(r)*((l1*sin(q1))/2 + 1/10) + (l1*cos(q1)*sin(p))/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        m2*cos(p)*cos(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) - m1*((l1*sin(q1))/2 + 1/10)*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p)) - m2*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) + (l1*m1*cos(p)*cos(q1)*cos(y))/2,     (m2*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + (l1*m1*cos(q1))/2)*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y)) - cos(p)*sin(y)*(m2*(l1*sin(q1) + (l2*sin(q1 - q2))/2) + (l1*m1*sin(q1))/2), (l2*m2*sin(q1 - q2)*cos(p)*sin(y))/2 - (l2*m2*cos(q1 - q2)*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y)))/2;
                                                                                                                                                                                                                                                 0,                                                                                                                                                                                                                                               0,                                                                                                                                                                                                                           m1 + m2 + mb,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (m2*cos(p)*sin(r)*(10*l1*sin(q1) + 5*l2*sin(q1 - q2) + 1))/10 + (m1*cos(p)*sin(r)*(5*l1*sin(q1) + 1))/10,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (m1*cos(r)*sin(p))/10 + (m2*cos(r)*sin(p))/10 - (l2*m2*cos(q1 - q2)*cos(p))/2 - (l1*m1*cos(p)*cos(q1))/2 - l1*m2*cos(p)*cos(q1) + (l2*m2*sin(q1 - q2)*cos(r)*sin(p))/2 + (l1*m1*cos(r)*sin(p)*sin(q1))/2 + l1*m2*cos(r)*sin(p)*sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                     sin(p)*(m2*(l1*sin(q1) + (l2*sin(q1 - q2))/2) + (l1*m1*sin(q1))/2) - cos(p)*cos(r)*(m2*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + (l1*m1*cos(q1))/2),                                        -(l2*m2*(sin(q1 - q2)*sin(p) - cos(q1 - q2)*cos(p)*cos(r)))/2;
                                                                                                                                -((cos(r)*sin(y) - cos(y)*sin(p)*sin(r))*(m1 + m2 + 5*l1*m1*sin(q1) + 10*l1*m2*sin(q1) + 5*l2*m2*sin(q1 - q2)))/10,                                                                                                                               ((cos(r)*cos(y) + sin(p)*sin(r)*sin(y))*(m1 + m2 + 5*l1*m1*sin(q1) + 10*l1*m2*sin(q1) + 5*l2*m2*sin(q1 - q2)))/10,                                                                                                                               (m2*cos(p)*sin(r)*(10*l1*sin(q1) + 5*l2*sin(q1 - q2) + 1))/10 + (m1*cos(p)*sin(r)*(5*l1*sin(q1) + 1))/10,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Ix + m1/100 + m2/100 + (l1^2*m1)/8 + (l1^2*m2)/2 + (l2^2*m2)/8 + (l2^2*m2*sin(q1 - q2)^2)/12 + (l1*m1*sin(q1))/10 + (l1*m2*sin(q1))/5 + (l2*m2*sin(q1 - q2))/10 - (l1^2*m1*cos(2*q1))/8 - (l1^2*m2*cos(2*q1))/2 + (l1^2*m1*sin(q1)^2)/12 - (l2^2*m2*cos(2*q1 - 2*q2))/8 - (l1*l2*m2*cos(2*q1 - q2))/2 + (l1*l2*m2*cos(q2))/2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        - sin(r)*((m1*sin(2*q1)*l1^2)/24 + (m2*sin(2*q1 - 2*q2)*l2^2)/24) - (sin(r)*((5*l2^2*m2*sin(2*q1 - 2*q2))/2 + l1*m1*cos(q1) + 2*l1*m2*cos(q1) + l2*m2*cos(q1 - q2) + (5*l1^2*m1*sin(2*q1))/2 + 10*l1^2*m2*sin(2*q1) + 10*l1*l2*m2*sin(2*q1 - q2)))/20, cos(p)*cos(r)*((m1*sin(2*q1)*l1^2)/24 + (m2*sin(2*q1 - 2*q2)*l2^2)/24) - sin(p)*(Ix + (l2^2*m2*sin(q1 - q2)^2)/12 + (l1^2*m1*sin(q1)^2)/12) - cos(p)*cos(y)*(m2*((sin(r)*sin(y) + cos(r)*cos(y)*sin(p))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) - cos(p)*cos(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2))*(sin(p)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + cos(p)*cos(r)*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10)) + m1*(((l1*sin(q1))/2 + 1/10)*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p)) - (l1*cos(p)*cos(q1)*cos(y))/2)*(cos(p)*cos(r)*((l1*sin(q1))/2 + 1/10) + (l1*cos(q1)*sin(p))/2)) - sin(p)*(m2*(((sin(r)*sin(y) + cos(r)*cos(y)*sin(p))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) - cos(p)*cos(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2))^2 + ((cos(y)*sin(r) - cos(r)*sin(p)*sin(y))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) + cos(p)*sin(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2))^2) + m1*((((l1*sin(q1))/2 + 1/10)*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p)) - (l1*cos(p)*cos(q1)*cos(y))/2)^2 + (((l1*sin(q1))/2 + 1/10)*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y)) + (l1*cos(p)*cos(q1)*sin(y))/2)^2)) + cos(p)*sin(y)*(m2*((cos(y)*sin(r) - cos(r)*sin(p)*sin(y))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) + cos(p)*sin(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2))*(sin(p)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + cos(p)*cos(r)*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10)) + m1*(((l1*sin(q1))/2 + 1/10)*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y)) + (l1*cos(p)*cos(q1)*sin(y))/2)*(cos(p)*cos(r)*((l1*sin(q1))/2 + 1/10) + (l1*cos(q1)*sin(p))/2)),                                                                                                                                                                                  0,                                                                                                    0;
                                                     - m2*cos(y)*(sin(p)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + cos(p)*cos(r)*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10)) - m1*cos(y)*(cos(p)*cos(r)*((l1*sin(q1))/2 + 1/10) + (l1*cos(q1)*sin(p))/2),                                                   - m2*sin(y)*(sin(p)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + cos(p)*cos(r)*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10)) - m1*sin(y)*(cos(p)*cos(r)*((l1*sin(q1))/2 + 1/10) + (l1*cos(q1)*sin(p))/2), (m1*cos(r)*sin(p))/10 + (m2*cos(r)*sin(p))/10 - (l2*m2*cos(q1 - q2)*cos(p))/2 - (l1*m1*cos(p)*cos(q1))/2 - l1*m2*cos(p)*cos(q1) + (l2*m2*sin(q1 - q2)*cos(r)*sin(p))/2 + (l1*m1*cos(r)*sin(p)*sin(q1))/2 + l1*m2*cos(r)*sin(p)*sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  - sin(r)*((m1*sin(2*q1)*l1^2)/24 + (m2*sin(2*q1 - 2*q2)*l2^2)/24) - (sin(r)*((5*l2^2*m2*sin(2*q1 - 2*q2))/2 + l1*m1*cos(q1) + 2*l1*m2*cos(q1) + l2*m2*cos(q1 - q2) + (5*l1^2*m1*sin(2*q1))/2 + 10*l1^2*m2*sin(2*q1) + 10*l1*l2*m2*sin(2*q1 - q2)))/20,                                                                                                                        (m1*cos(r)^2)/100 + (m2*cos(r)^2)/100 + sin(r)^2*(Iz + (l1^2*m1*cos(q1)^2)/12 + (l2^2*m2*cos(q1 - q2)^2)/12) + cos(r)^2*((m1*l1^2)/12 + (m2*l2^2)/12 + Iy) + (l2^2*m2)/4 + (l1^2*m1*cos(q1)^2)/4 + l1^2*m2*cos(q1)^2 - (l2^2*m2*cos(q1)^2)/4 - (l2^2*m2*cos(q2)^2)/4 + (l1^2*m1*cos(r)^2)/4 + l1^2*m2*cos(r)^2 - (l1^2*m1*cos(q1)^2*cos(r)^2)/4 - l1^2*m2*cos(q1)^2*cos(r)^2 + (l2^2*m2*cos(q1)^2*cos(r)^2)/4 + (l2^2*m2*cos(q2)^2*cos(r)^2)/4 + (l1*m1*cos(r)^2*sin(q1))/10 + (l1*m2*cos(r)^2*sin(q1))/5 + (l2^2*m2*cos(q1)^2*cos(q2)^2)/2 - (l2*m2*cos(q1)*cos(r)^2*sin(q2))/10 + (l2*m2*cos(q2)*cos(r)^2*sin(q1))/10 - (l2^2*m2*cos(q1)^2*cos(q2)^2*cos(r)^2)/2 + l1*l2*m2*cos(q1)^2*cos(q2) + l1*l2*m2*cos(q2)*cos(r)^2 + (l2^2*m2*cos(q1)*cos(q2)*sin(q1)*sin(q2))/2 + l1*l2*m2*cos(q1)*sin(q1)*sin(q2) - l1*l2*m2*cos(q1)^2*cos(q2)*cos(r)^2 - (l2^2*m2*cos(q1)*cos(q2)*cos(r)^2*sin(q1)*sin(q2))/2 - l1*l2*m2*cos(q1)*cos(r)^2*sin(q1)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                      sin(y)*(m2*((sin(r)*sin(y) + cos(r)*cos(y)*sin(p))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) - cos(p)*cos(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2))*(sin(p)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + cos(p)*cos(r)*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10)) + m1*(((l1*sin(q1))/2 + 1/10)*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p)) - (l1*cos(p)*cos(q1)*cos(y))/2)*(cos(p)*cos(r)*((l1*sin(q1))/2 + 1/10) + (l1*cos(q1)*sin(p))/2)) + cos(y)*(m2*((cos(y)*sin(r) - cos(r)*sin(p)*sin(y))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) + cos(p)*sin(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2))*(sin(p)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + cos(p)*cos(r)*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10)) + m1*(((l1*sin(q1))/2 + 1/10)*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y)) + (l1*cos(p)*cos(q1)*sin(y))/2)*(cos(p)*cos(r)*((l1*sin(q1))/2 + 1/10) + (l1*cos(q1)*sin(p))/2)) + sin(p)*sin(r)*((m1*sin(2*q1)*l1^2)/24 + (m2*sin(2*q1 - 2*q2)*l2^2)/24) - cos(p)*cos(r)*sin(r)*(Iz + (l1^2*m1*cos(q1)^2)/12 + (l2^2*m2*cos(q1 - q2)^2)/12) + cos(p)*cos(r)*sin(r)*((m1*l1^2)/12 + (m2*l2^2)/12 + Iy),               (cos(r)*(5*l1^2*m1 + 20*l1^2*m2 + 5*l2^2*m2 + l1*m1*sin(q1) + 2*l1*m2*sin(q1) + l2*m2*sin(q1 - q2) + 20*l1*l2*m2*cos(q2)))/20 + cos(r)*((m1*l1^2)/12 + (m2*l2^2)/12),                      - (l2^2*m2*cos(r))/12 - (l2*m2*cos(r)*(5*l2 + sin(q1 - q2) + 10*l1*cos(q2)))/20;
 - m2*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) - m1*((l1*sin(q1))/2 + 1/10)*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y)) - m2*cos(p)*sin(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) - (l1*m1*cos(p)*cos(q1)*sin(y))/2, m2*cos(p)*cos(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) - m1*((l1*sin(q1))/2 + 1/10)*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p)) - m2*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) + (l1*m1*cos(p)*cos(q1)*cos(y))/2,                                                                                                                                                                                                                                      0, cos(p)*cos(r)*((m1*sin(2*q1)*l1^2)/24 + (m2*sin(2*q1 - 2*q2)*l2^2)/24) - sin(p)*(Ix + (l2^2*m2*sin(q1 - q2)^2)/12 + (l1^2*m1*sin(q1)^2)/12) - cos(p)*cos(y)*(m2*((sin(r)*sin(y) + cos(r)*cos(y)*sin(p))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) - cos(p)*cos(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2))*(sin(p)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + cos(p)*cos(r)*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10)) + m1*(((l1*sin(q1))/2 + 1/10)*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p)) - (l1*cos(p)*cos(q1)*cos(y))/2)*(cos(p)*cos(r)*((l1*sin(q1))/2 + 1/10) + (l1*cos(q1)*sin(p))/2)) - sin(p)*(m2*(((sin(r)*sin(y) + cos(r)*cos(y)*sin(p))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) - cos(p)*cos(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2))^2 + ((cos(y)*sin(r) - cos(r)*sin(p)*sin(y))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) + cos(p)*sin(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2))^2) + m1*((((l1*sin(q1))/2 + 1/10)*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p)) - (l1*cos(p)*cos(q1)*cos(y))/2)^2 + (((l1*sin(q1))/2 + 1/10)*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y)) + (l1*cos(p)*cos(q1)*sin(y))/2)^2)) + cos(p)*sin(y)*(m2*((cos(y)*sin(r) - cos(r)*sin(p)*sin(y))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) + cos(p)*sin(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2))*(sin(p)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + cos(p)*cos(r)*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10)) + m1*(((l1*sin(q1))/2 + 1/10)*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y)) + (l1*cos(p)*cos(q1)*sin(y))/2)*(cos(p)*cos(r)*((l1*sin(q1))/2 + 1/10) + (l1*cos(q1)*sin(p))/2)), sin(y)*(m2*((sin(r)*sin(y) + cos(r)*cos(y)*sin(p))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) - cos(p)*cos(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2))*(sin(p)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + cos(p)*cos(r)*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10)) + m1*(((l1*sin(q1))/2 + 1/10)*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p)) - (l1*cos(p)*cos(q1)*cos(y))/2)*(cos(p)*cos(r)*((l1*sin(q1))/2 + 1/10) + (l1*cos(q1)*sin(p))/2)) + cos(y)*(m2*((cos(y)*sin(r) - cos(r)*sin(p)*sin(y))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) + cos(p)*sin(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2))*(sin(p)*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + cos(p)*cos(r)*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10)) + m1*(((l1*sin(q1))/2 + 1/10)*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y)) + (l1*cos(p)*cos(q1)*sin(y))/2)*(cos(p)*cos(r)*((l1*sin(q1))/2 + 1/10) + (l1*cos(q1)*sin(p))/2)) + sin(r)*(sin(p)*((m1*sin(2*q1)*l1^2)/24 + (m2*sin(2*q1 - 2*q2)*l2^2)/24) - cos(p)*cos(r)*(Iz + (l1^2*m1*cos(q1)^2)/12 + (l2^2*m2*cos(q1 - q2)^2)/12)) + cos(p)*cos(r)*sin(r)*((m1*l1^2)/12 + (m2*l2^2)/12 + Iy),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        m2*(((sin(r)*sin(y) + cos(r)*cos(y)*sin(p))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) - cos(p)*cos(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2))^2 + ((cos(y)*sin(r) - cos(r)*sin(p)*sin(y))*(l1*sin(q1) + (l2*sin(q1 - q2))/2 + 1/10) + cos(p)*sin(y)*(l1*cos(q1) + (l2*cos(q1 - q2))/2))^2) + m1*((((l1*sin(q1))/2 + 1/10)*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p)) - (l1*cos(p)*cos(q1)*cos(y))/2)^2 + (((l1*sin(q1))/2 + 1/10)*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y)) + (l1*cos(p)*cos(q1)*sin(y))/2)^2) + sin(p)*(sin(p)*(Ix + (l2^2*m2*sin(q1 - q2)^2)/12 + (l1^2*m1*sin(q1)^2)/12) - cos(p)*cos(r)*((m1*sin(2*q1)*l1^2)/24 + (m2*sin(2*q1 - 2*q2)*l2^2)/24)) - cos(p)*cos(r)*(sin(p)*((m1*sin(2*q1)*l1^2)/24 + (m2*sin(2*q1 - 2*q2)*l2^2)/24) - cos(p)*cos(r)*(Iz + (l1^2*m1*cos(q1)^2)/12 + (l2^2*m2*cos(q1 - q2)^2)/12)) + cos(p)^2*sin(r)^2*((m1*l1^2)/12 + (m2*l2^2)/12 + Iy), (cos(p)*sin(r)*(5*l1^2*m1 + 20*l1^2*m2 + 5*l2^2*m2 + l1*m1*sin(q1) + 2*l1*m2*sin(q1) + l2*m2*sin(q1 - q2) + 20*l1*l2*m2*cos(q2)))/20 + cos(p)*sin(r)*((m1*l1^2)/12 + (m2*l2^2)/12),        - (l2^2*m2*cos(p)*sin(r))/12 - (l2*m2*cos(p)*sin(r)*(5*l2 + sin(q1 - q2) + 10*l1*cos(q2)))/20;
                                                                  - (m2*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + (l1*m1*cos(q1))/2)*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p)) - cos(p)*cos(y)*(m2*(l1*sin(q1) + (l2*sin(q1 - q2))/2) + (l1*m1*sin(q1))/2),                                                                  (m2*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + (l1*m1*cos(q1))/2)*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y)) - cos(p)*sin(y)*(m2*(l1*sin(q1) + (l2*sin(q1 - q2))/2) + (l1*m1*sin(q1))/2),                                                                                         sin(p)*(m2*(l1*sin(q1) + (l2*sin(q1 - q2))/2) + (l1*m1*sin(q1))/2) - cos(p)*cos(r)*(m2*(l1*cos(q1) + (l2*cos(q1 - q2))/2) + (l1*m1*cos(q1))/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (cos(r)*(5*l1^2*m1 + 20*l1^2*m2 + 5*l2^2*m2 + l1*m1*sin(q1) + 2*l1*m2*sin(q1) + l2*m2*sin(q1 - q2) + 20*l1*l2*m2*cos(q2)))/20 + cos(r)*((m1*l1^2)/12 + (m2*l2^2)/12),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (cos(p)*sin(r)*(5*l1^2*m1 + 20*l1^2*m2 + 5*l2^2*m2 + l1*m1*sin(q1) + 2*l1*m2*sin(q1) + l2*m2*sin(q1 - q2) + 20*l1*l2*m2*cos(q2)))/20 + cos(p)*sin(r)*((m1*l1^2)/12 + (m2*l2^2)/12),                                                                                                                             (m2*(3*l1^2 + 3*cos(q2)*l1*l2 + l2^2))/3 + (l1^2*m1)/3,                                                                     -(l2*m2*(2*l2 + 3*l1*cos(q2)))/6;
                                                                                                                                              (l2*m2*cos(q1 - q2)*(sin(r)*sin(y) + cos(r)*cos(y)*sin(p)))/2 + (l2*m2*sin(q1 - q2)*cos(p)*cos(y))/2,                                                                                                                                            (l2*m2*sin(q1 - q2)*cos(p)*sin(y))/2 - (l2*m2*cos(q1 - q2)*(cos(y)*sin(r) - cos(r)*sin(p)*sin(y)))/2,                                                                                                                                                                          -(l2*m2*(sin(q1 - q2)*sin(p) - cos(q1 - q2)*cos(p)*cos(r)))/2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              - (l2^2*m2*cos(r))/12 - (l2*m2*cos(r)*(5*l2 + sin(q1 - q2) + 10*l1*cos(q2)))/20,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          - (l2^2*m2*cos(p)*sin(r))/12 - (l2*m2*cos(p)*sin(r)*(5*l2 + sin(q1 - q2) + 10*l1*cos(q2)))/20,                                                                                                                                                   -(l2*m2*(2*l2 + 3*l1*cos(q2)))/6,                                                                                          (l2^2*m2)/3];

end

